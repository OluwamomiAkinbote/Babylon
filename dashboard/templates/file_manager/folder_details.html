{% extends 'admin_partials/admin_base.html' %}


{% block content %}
<div class="container mx-auto px-4 py-8 bg-gray-50 border border-gray-300">
    <nav class="text-gray-600 text-sm mb-6">
        {% if current_folder.parent_folder %}
            <a href="{% url 'folder_detail' current_folder.parent_folder.id %}" class="hover:underline">Back</a> / 
        {% endif %}
        <span class="font-bold">{{ current_folder.name }}</span>
    </nav>

    <h1 class="text-3xl font-bold mb-6 text-gray-800 text-center">{{ current_folder.name }} - Files</h1>

    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
        {% for file in files %}
        <div class="bg-white border border-gray-300 p-4 text-center transition-transform transform hover:scale-105 cursor-pointer"
             onclick="selectFile('{{ file.id }}', '{{ file.file.url }}')">
            {% if file.file_type == 'image' %}
                <img src="{{ file.file.url }}" alt="{{ file.name }}" class="w-full h-40 object-cover mb-4">
            {% elif file.file_type == 'video' %}
                <video controls class="w-full h-40 object-cover mb-4">
                    <source src="{{ file.file.url }}" type="video/{{ file.extension }}">
                </video>
            {% elif file.file_type == 'pdf' %}
                <iframe src="{{ file.file.url }}" class="w-full h-40 mb-4"></iframe>
            {% else %}
                <p class="text-gray-500 mb-4">Unsupported File Type</p>
            {% endif %}
            <h3 class="font-semibold text-gray-800 truncate">{{ file.name }}</h3>
        </div>
        {% empty %}
        <p class="col-span-full text-gray-500 text-center">No files available in this folder.</p>
        {% endfor %}
    </div>
</div>

<script>
    function selectFile(fileId, fileUrl) {
        // Pass the file data back to the Create Post page
        window.opener.selectFile(fileId, fileUrl);
        window.close(); // Close the File Manager
    }
</script>
{% endblock %}
